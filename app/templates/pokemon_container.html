<head>
    <link rel="stylesheet" href='../static/css/pokemon_container.css'>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Jacquard+12&family=Kanit:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&family=Tiny5&display=swap" rel="stylesheet">    
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
</head>

<body>
    <h1 id="title">CREATE A NEW BUILD</h1>
    <form action="" class="container_build_name">
        <label for="">BUILD NAME</label>
        <input type="text">
    </form>

    <div class="container_all_pokemon">
        {% for i in range (6) %}
            <div class="pokemon_container">
                <div class="search_container"> 
                    <select name="" class="select-pokemon pokemon_{{i+1}}">
                        <option value="">Seleccione un Pokemon</option>
                        {%for pokemon in pokemons%}
                            <option value="{{ pokemon.name }}" data-pokedex-id="{{ pokemon.especie }}" data-level='{{ pokemon.level }}'
                            data-ability-1="{{ pokemon.ability_1 }}" data-ability-2="{{ pokemon.ability_2 }}" data-ability-3="{{ pokemon.ability_3 }}" 
                            data-ability-4="{{ pokemon.ability_4 }}" data-name="{{pokemon.name}}">{{ pokemon.name }}</option>
                        {%endfor%}
                    </select> 
                </div>
                <div class="datos_container">    
                    <div class="img_container">
                        <img class="img_pokemon" src="../static/images/Logo.png">
                    </div>
                    <div class="info_container"> 
                        <label for="" class="name">NAME: </label><br>
                        <label for="" class="poke_LVL">LVL: </label><br>
                        <label for="" class="poke_habilidad_1">ABILITY 1: </label><br>
                        <label for="" class="poke_habilidad_2">ABILITY 2: </label><br>
                        <label for="" class="poke_habilidad_3">ABILITY 3: </label><br>
                        <label for="" class="poke_habilidad_4">ABILITY 4: </label>
                    </div>
                </div>
            </div>
        {% endfor %}
    </div>

    <div class="btn_nav">
        <button class="btn">Cancel</button>
        <button class="btn">Save</button>
    </div>
</body>

<script>
$(document).ready(function() {
    $('.select-pokemon').select2({
        tags: true,
        placeholder: "Busca a tu pokemon...",
        allowClear: true
    });

    // Función para procesar los datos basados en el elemento que cambió
    function procesar_datos(selectedOption, container) {
        console.log('hola');
        if (selectedOption.value !== "") {
            var name = $(selectedOption).attr('data-name');
            var lvl = $(selectedOption).attr('data-level');
            container.find('.name').html(name);
            container.find('.poke_LVL').html('LVL: ' + lvl);
            for (var i = 1; i <= 4; i++) {
                container.find('.poke_habilidad_' + i).html($(selectedOption).attr('data-ability-' + i));
            }
            // container.find('.img_pokemon').val(selectedOption.getAttribute('data-pokedex-id'));
        } else {
            container.find('.poke_LVL').html("");
            for (var i = 1; i <= 4; i++) {
                container.find('.poke_habilidad_' + i).html("");
            }
        }
    }

    // Evento change para cada select de pokemon
    $('.pokemon_1').change(function() {
        var selectedOption = this.options[this.selectedIndex];
        var container = $(this).closest('.pokemon-container');
        procesar_datos(selectedOption, container);
    });

    $('.pokemon_2').change(function() {
        var selectedOption = this.options[this.selectedIndex];
        var container = $(this).closest('.pokemon-container');
        procesar_datos(selectedOption, container);
    });

    $('.pokemon_3').change(function() {
        var selectedOption = this.options[this.selectedIndex];
        var container = $(this).closest('.pokemon-container');
        procesar_datos(selectedOption, container);
    });

    $('.pokemon_4').change(function() {
        var selectedOption = this.options[this.selectedIndex];
        var container = $(this).closest('.pokemon-container');
        procesar_datos(selectedOption, container);
    });

    $('.pokemon_5').change(function() {
        var selectedOption = this.options[this.selectedIndex];
        var container = $(this).closest('.pokemon-container');
        procesar_datos(selectedOption, container);
    });

    $('.pokemon_6').change(function() {
        var selectedOption = this.options[this.selectedIndex];
        var container = $(this).closest('.pokemon-container');
        procesar_datos(selectedOption, container);
    });
});
</script>